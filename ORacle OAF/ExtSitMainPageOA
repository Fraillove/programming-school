package TreetGroup.oracle.apps.per.selfservice.specialinformation.webui;

import java.sql.CallableStatement;

import java.sql.Types;

import oracle.apps.fnd.framework.OAApplicationModule;
import oracle.apps.fnd.framework.OAException;
import oracle.apps.fnd.framework.server.OADBTransaction;
import oracle.apps.fnd.framework.webui.OAPageContext;
import oracle.apps.fnd.framework.webui.beans.OAWebBean;
import oracle.apps.per.selfservice.common.SSHRParams;

//import oracle.apps.per.selfservice.common.webui.SSHRParams;
import oracle.apps.per.selfservice.specialinformation.webui.SitMainPageCO;



public class ExtSitMainPageCO extends SitMainPageCO {
    public ExtSitMainPageCO() {
    }



    public void processRequest(OAPageContext pageContext, OAWebBean webBean)
    {
                super.processRequest(pageContext, webBean);

     }

     // Now ProcessFromRequest
      public void processFormRequest(OAPageContext pageContext,OAWebBean webBean)
      {

    //Customized Code below

     OAApplicationModule localOAApplicationModule = pageContext.getApplicationModule(webBean);
    /*

      oracle.apps.per.selfservice.common.webui.CommonUtils.activateWarning(pageContext, webBean);
      oracle.apps.per.common.CommonUtils.setFuncPromptAsPageTitle(pageContext, false, false);

      WFUtility.isTransactionSubmitted(pageContext);
      if (pageContext.isLoggingEnabled(2))
      {
        pageContext.writeDiagnostics(this, "SitMainPageCO: processRequest starting", 2);
      }

      SSHRParams localSSHRParams = new SSHRParams(localOAApplicationModule.getOADBTransaction());

      OAApplicationModule am = pageContext.getApplicationModule(webBean);




    //           String event = pageContext.getParameter("event");
    //           throw new OAException( event ,OAException.ERROR);


             String event = pageContext.getParameter("event");

             String str1 = localSSHRParams.getPersonId();
             */
     // /*
     SSHRParams localSSHRParams = new SSHRParams(localOAApplicationModule.getOADBTransaction());
     String str1 = localSSHRParams.getItemType();
     String str2 = localSSHRParams.getItemKey();
     String str3 = localSSHRParams.getActivityId();
     String str4 = localSSHRParams.getPersonId();
   //  */
             if (pageContext.getParameter("HrNext") != null)
           // if (event !=null)
            {

                try{
                    OADBTransaction txn = localOAApplicationModule.getOADBTransaction();
                    CallableStatement cs = txn.createCallableStatement("BEGIN :1 :=   TGC_FUND_NOMINEE_PERCENTAGE_F(:2);END;",1);
                    int a = Integer.parseInt(str4);
                   // int c = Integer.parseInt(str4);
                    cs.registerOutParameter(1,Types.NUMERIC);
                    cs.setInt(2,a);
                   // cs.setInt(3,c);
                    cs.execute();
                    int result = cs.getInt(1);
                    cs.close();
                //                         int Openings = Integer.parseInt(NumberOfOpenings);
                    if(result != 100){
                        throw new OAException("WEIGHTING PERCENT is greater than 100, You has assgined WEIGHTING PERCENT = "+result,OAException.ERROR);
                    }


                }
                catch(Exception e){
                    throw new OAException(e.getMessage(),OAException.ERROR);
                }
               // throw new OAException("Testing by Faisal Test case: 03 :"+" person id :  "+str4+"-"+str1+"-"+str2+"-"+str3,OAException.ERROR);
            }

       super.processFormRequest(pageContext, webBean);
     //The below is termination of processFormRequest

         }


     // Below is customized class termination



    }

    
